var mysql = require('mysql');

// Create a connection pool for MySql Server and Database
var pool = mysql.createPool({
  host : 'hungryprogrammer.com',
  //host : 'localhost',
  user : 'hungryp_ortho',
  password : '0rth0@c0d3r',
  database: 'hungryp_ortho2',
  port : 3306
});

function getData(sqlStr, results) {
  pool.getConnection(function(err, connection){

    if(err) {
      console.error('[odbcon.getData.getConnection] ' + err+'\n');
    }
    console.log("[odbcon.getData.getConnection] open");
    connection.query(sqlStr, function(err, rows){
      // There was a error or not?
      if (results != null) {
        if(err != null) {
          results(err, null);
          console.error("[odbcon.query] " + err);
        } else {
          results(null, rows);
          for (i=0; i<rows.length; i++) {
            console.log('[odbcon.query] ' + rows[i]);
           }
        }
      }
      connection.release();
    });
  });
}

exports.getData = getData;

